<div class="history-container">
  <!-- Header -->
  <header class="history-header">
    <button mat-icon-button class="back-btn" (click)="goBack()">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1 class="page-title">Resume History</h1>
    <div class="header-spacer"></div>
  </header>

  <!-- Resume List -->
  <div class="resumes-list" *ngIf="resumes.length; else noHistory">
    <mat-card *ngFor="let resume of paginatedResumes" class="resume-card">
      <div class="card-content">
        <div class="resume-info">
          <div class="file-name-row">
            <h3 class="file-name">{{ resume.filename }}</h3>
            <mat-chip *ngIf="resume.type === 'job_match'" class="analysis-type-chip match-chip"
              aria-label="Job Match Analysis">
              JD Match
            </mat-chip>
            <mat-chip *ngIf="resume.type === 'standard'" class="analysis-type-chip standard-chip"
              aria-label="Standard ATS Analysis">
              ATS Score
            </mat-chip>
          </div>
          <p class="analyzed-date">{{ resume.createdAt | date:'MMM d, y' }}</p>
        </div>
        <div class="score-badge" [ngClass]="getScoreClass(resume.score)">
          {{ (resume?.score || resume.analysis?.free_feedback?.score) }}/10
        </div>
      </div>
      <div class="card-actions">
        <button mat-button color="primary" (click)="viewResume(resume)">
          <mat-icon>visibility</mat-icon>
          View Details
        </button>
      </div>
    </mat-card>

    <!-- Pagination Controls -->
    <div class="pagination-controls" *ngIf="totalPages > 1">
      <button
        mat-button
        [disabled]="currentPage === 1"
        (click)="goToPage(currentPage - 1)"
        class="pagination-btn">
        <mat-icon>chevron_left</mat-icon>
        Prev
      </button>

      <div class="page-numbers">
        <button
          *ngFor="let page of getPageNumbers()"
          mat-button
          [class.active]="page === currentPage"
          (click)="goToPage(page)"
          class="page-btn">
          {{ page }}
        </button>
      </div>

      <button
        mat-button
        [disabled]="currentPage === totalPages"
        (click)="goToPage(currentPage + 1)"
        class="pagination-btn">
        Next
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
  </div>

  <!-- Empty State -->
  <ng-template #noHistory>
    <div class="empty-state">
      <h3>No resume history</h3>
      <p>You havenâ€™t analyzed any resumes yet.</p>
    </div>
  </ng-template>
</div>
